{% extends "base_generic.html" %}

<!--This is an html response page for ~/library/patrons/ url that shows content information
(FirstName, LastName (from internal user model))
(address, telegram, phone number (from patronInfo model))
about user-->

{% block content %}

    <h1>Patron detail</h1>
    <div>
        <p>Personal data</p>
        <table>
            <tr>
                <td><b>Patron ID: </b></td>
                <td>{{ user.id }}</td>
            </tr>
            <tr>
                <td><b>Full name: </b></td>
                <td>{{ FirstName }} {{ LastName }}</td>
            </tr>
            <tr>
                <td><b>Email:</b></td>
                <td>{{ Email }}</td>
            </tr>
            <tr>
                <td><b>Address:</b></td>
                <td>{{ Address }}</td>
            </tr>
            <tr>
                <td><b>Telegram</b></td>
                <td>{{ Telegram }}</td>
            </tr>
            <tr>
                <td><b>Phone Number: </b></td>
                <td>{{ Phone_Number }}</td>
            </tr>
        </table>
    </div>

    {% if reservation_table %}
        <div>
            <table border="1" align="left" width="80%">
                <caption> Materials that patron waits for now:</caption>
                <tr>
                    <th> Document</th>
                    <th> Actions</th>
                </tr>

                {% for reservation in reservation_table %}
                    <tr>
                        <th>
                            <a href="{{ reservation.document.get_absolute_url }}">{{ reservation.document_copy.summary }}</a>
                        </th>
                        {% if reservation.document_copy.status == 'r' %}
                            <th bgcolor="#98fb98" title="Give out the copy">
                                <a href="{% url 'giveout-confirmation' id=reservation.id %}"> Give out </a>
                            </th>
                        {% else %}
                            <th bgcolor="#f08080">
                                Out of stock
                            </th>
                        {% endif %}
                    </tr>
                {% endfor %}
            </table>
        </div>
    {% else %}
        <div>Patron didn't reserve anything</div>
    {% endif %}
    <hr>
    {% if giveout_table %}
        <div>

            <table border="1" align="left" width="80%">
                <caption> Materials that patron have:</caption>
                <tr>
                    <th> Timestamp</th>
                    <th> Document</th>
                    <th> Return date</th>
                    <th> Action</th>
                </tr>

                {% for issuance in giveout_table %}
                    <tr>
                        <th> {{ issuance.timestamp }}</th>
                        <th>
                            <a href="{{ issuance.document.get_absolute_url }}">{{ issuance.document_instance.summary }}</a>
                        </th>
                        <th> {{ issuance.document_instance.due_back }}</th>
                        <th><a href="{{ issuance.document_instance.form_return_request_mail }}">Request to return</a>
                        </th>
                    </tr>
                {% endfor %}
            </table>
        </div>

    {% else %}
        <br>
        <div>Patron doesn't have any documents</div>
    {% endif %}



{% endblock %}
